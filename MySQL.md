# MySQL

什么是数据库？

数据库是保存有组织的数据的容器，需要与数据库软件进行区分，数据库是通过DBMS创建和操纵的容器

什么是表？

某种特定类型数据的结构化清单

什么是列？

表中的一个字段，所有表都是由一个或多个列组成的

数据类型？

所容许的数据的类型，每个表列都有相应的数据类型，它限制该列中存储的数据

什么是行？

表中的一个记录

什么是主键？

一列，其值能够唯一区分表中每个行

什么是SQL？

Structured Query Language的缩写，一种专门用来与数据库通信的语言

## 检索数据

SELECT语句

1. SELECT columnName FROM table;
2. SELECT DISTINCT columnName FROM table;
3. SELECT columnName FROM table LIMIT number;



## 排序检索数据

1. SELECT columnName FROM table ORDER BY columnName; 按某列排序
2. SELECT columnName FROM table ORDER BY columnName1,columnName2...; 按多个列排序

### 指定排序方向

1. SELECT columnName FROM table ORDER BY columnName DESC;	按降序排序

   若想对多个列进行降序排序需要对每个列指定DESC关键字



## 过滤数据

WHERE子句操作符

| 操作符  |     说明     |
| :-----: | :----------: |
|    =    |     等于     |
|   <>    |    不等于    |
|   !=    |    不等于    |
|    <    |     小于     |
|   <=    |   小于等于   |
|    >    |     大于     |
|   >=    |   大于等于   |
| BETWEEN | 介于两者之间 |



1. SELECT columnName FROM table WHERE conditon;   一般表示
2. SELECT columnName FROM table WHERE columnName IS NULL; 检查空值



## 数据过滤

### 组合WHERE语句

以AND或OR操作符联结WHERE子句达到更强的过滤控制，但是AND相对于OR具有更高的优先级，所以当多个操作符出现时使用圆括号保证语义正确

### IN

用来指定条件范围，范围中的每个条件都可以进行匹配，作用与OR相当

NOT

否定它之后所跟的任何条件



## 用通配符进行过滤

什么是通配符？

用来匹配值的一部分的特殊字符

搜索模式：由字面值、通配符或者两者组合构成的搜索条件

### 百分号%通配符

表示任何字符出现任意次数

### 下划线通配符

匹配任意单个字符



## 用正则表达式进行搜索

1. 匹配几个字符之一可使用[]
2. 匹配范围[range]
3. 匹配多个实例
   - *:0个或多个匹配
   - +:1个或多个匹配
   - ？:0个或1个匹配
   - {n}:指定数目的匹配
   - {n,}:不少于指定数目的匹配
   - {n,m}:匹配数目的范围
4. 定位符
   - ^:文本的开始
   - $:文本的结尾
   - [[:<:]]:词的开始
   - [[:>:]]:词的结尾

## 创建计算字段

什么是字段？

基本上与列的意思相同，不过数据库列一般称为列，而术语字段常用在计算字段的连接上

*只有数据库知道SELECT语句中哪些列是实际的表列，哪些列是计算字段，从客户机角度看，计算字段的数据是以与其他列的数据相同的方式返回的*



### 拼接字段

1. Concat拼接函数拼接两个列
2. RTrim函数去掉右边的所有空格

AS关键字可以为一个计算字段赋予别名



## 使用数据处理函数

### 文本处理函数

1. Upper函数，将文本转换为大写
2. Left，返回串左边的字符
3. Length，返回串的一个子串
4. Locate，找出串的一个子串
5. Lower，将串转为小写
6. LTrim,去掉串左边的空格
7. Right，返回串右边的字符
8. RTrim，去掉串右边的空格
9. Soundex，返回串的SOUNDEX值
10. SubString，返回子串的字符

### 日期和时间处理函数

1. AddDate，增加一个日期
2. AddTime，增加一个时间
3. CurDate，返回当前日期
4. CurTime，返回当前时间
5. Date，返回日期时间的日期部分
6. DateDiff，计算两个日期之差
7. Date_Add，高度灵活的日期运算函数
8. Date_Format，返回一个格式化的日期或时间串
9. Day，返回一个日期的天数部分
10. DayOfWeek，对于一个日期，返回对应的星期几
11. Hour，返回以时间的小时部分
12. Minute，返回一个时间的分钟部分
13. Month，返回一个日期的月份部分
14. Now，返回当前日期和时间
15. Second，返回一个时间的秒部分
16. Time，返回一个日期时间的时间部分
17. Year，返回一个日期的年份部分

### 数值处理函数

1. Abs
2. Cos
3. Exp
4. Mod
5. Pi
6. Rand
7. Sin
8. Sqrt
9. Tan

### 汇总数据

什么是聚集函数？

运行在行组上，计算和返回单个值的函数

1. AVG，返回某列的平均值
2. COUNT，返回某列的行数
3. MAX，返回某列的最大值
4. MIN，返回某列的最小值
5. SUM，返回某列值之和

## 分组数据

为什么需要数据分组？

因为在一些时候我们需要将数据按照某种逻辑分为多个组，从而允许后续对分组进行聚集计算

如何创建分组？

由GROUP BY子句建立

### 过滤分组

HAVING子句，与WHERE子句唯一的差别是WHERE过滤行，而HAVING过滤分组

### SELECT子句及其顺序



|   子句   |        说明        |      是否必须使用      |
| :------: | :----------------: | :--------------------: |
|  SELECT  | 要返回的列或表达式 |           是           |
|   FROM   |  从中检索数据的表  | 仅在从表选择数据时使用 |
|  WHERE   |      行级过滤      |           否           |
| GROUP BY |      分组说明      | 仅在按组计算聚集时使用 |
|  HAVING  |      组级过滤      |           否           |
| ORDER BY |    输出排序顺序    |           否           |
|  LIMIT   |     要检索的行     |           否           |



## 子查询

什么是子查询？

嵌套在其他查询中的查询



## 联结表

什么是关系表？

两个数据库表通过某些常用的值互相关联

为什么使用联结？

分解数据为多个表能更有效地存储，降低了数据之间的耦合性，但是同时增加了搜索的难度，数据存储在多个表中，怎样用单条SELECT语句检索出数据？解决办法便是联结

如何创建联结？

规定要联结的所有表以及它们如何关联即可

内部联结语法？

table1 INNER JOIN table2 ON condition

## 创建高级联结

### 对表使用别名

1. 在单条SELECT语句中不止一次引用相同的表
2. 代码简短

### 使用不同类型的联结

1. 自联结：联结的是同一个表，用起别名的方法进行区分
2. 外联结：没有联结的行也显示出来

## 组合查询

什么是组合查询？

执行多个查询，并将结果作为单个查询结果集返回

什么时候需要组合查询？

1. 在单个查询中从不同的表返回类似结构的数据
2. 对单个表执行多个查询，按单个查询返回数据

如何创建组合查询？

使用UNION操作符组合数条SQL查询

### 使用规则

- 必须由两条或两条以上的SELECT语句组成，语句之间用关键字UNION分割
- UNION中的每个查询必须包含相同的列、表达式或聚集函数
- 列数据类型必须兼容：类型不必完全相同，但必须可以隐式转换



## 全文本搜索

## 如何进行全文本搜索

使用两个函数Match和Against执行全文本搜索，其中Match指定被搜索的列，Against指定要使用的搜索表达式

## 插入数据

插入方式

1. 插入完整的行
2. 插入行的一部分
3. 插入多行
4. 插入某些查询的结果

### 插入单行

INSERT INTO tableName (列名)　VALUES(列值)；

### 插入多行

INSERT INTO tableName(列名)　VALUES(列值１)，(列值２)；



## 更新和删除数据

### 更新行的方式

1. 更新所有行
2. 更新特定行

命令组成UPDATE：

1. 要更新的表
2. 列名和它们的新值
3. 确定要更新行的过滤条件

UPDATE tableName SET column = newValue WHERE condition



### 删除行的方式

1. 删除所有行
2. 删除特定行

DELETE FROM tableName WHERE condition



## 创建和操纵表

### 创建表

CREATE TABLE命令创建表，需要提供表名和表列的名字和定义，并且用逗号分割

### 更新表

ALTER TABLE

### 删除表

DROP TABLE

### 重命名表

RENAME TABLE

## 视图

什么是视图？

视图是虚拟的表，与包含数据的表不一样，视图只包含使用时动态检索数据的查询

为什么使用视图？

1. 重用SQL语句
2. 简化复杂的SQL操作
3. 保护数据

### 如何使用视图？

CREATE VIEW



## 使用存储过程

什么是存储过程？

为以后的使用而保存的一条或者多条MySQL语句的集合

#### 如何使用存储过程？

CALL name

### 如何创建存储过程？

CREATE PROCEDURE name()

BEGIN

语句

END

## 使用游标

什么是游标？

存储在MySQL服务器上的数据库查询，它不是一条SELECT语句而是该语句检索出来的结果集，在存储了游标之后，应用程序可以根据需要滚动或浏览其中的数据

### 使用游标的步骤

1. 在能够使用游标前，必须声明定义它，这个过程实际上没有检索数据，它只是定义要使用的SELECT语句
2. 一旦声明后，必须打开游标以供使用，这个过程用前面定义的SELECT语句把数据实际检索出来
3. 对于填有数据的游标，根据需要取出各行
4. 在结束游标使用时，必须关闭游标

### 如何创建游标？

DECLARE name CURSOR



## 触发器

触发器是响应以下任意语句而自动执行的一条ＭySQL语句：

1. DELETE
2. INSERT
3. UPDATE

### 创建触发器需要的信息？

1. 唯一的触发器名
2. 触发器关联的表
3. 触发器应该响应的活动
4. 触发器何时执行



## 事务处理

什么是事务处理？

一种保证数据库不包含不完整的操作结果的机制

事务：指一组SQL语句

回退：指撤销指定SQL语句的过程

提交：指将未存储的SQL语句结果写入数据库表

保留点：指事务处理中设置的临时占位符，可以对它发布回退

















